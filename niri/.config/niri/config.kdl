// ┏┓╻╻┏━┓╻
// ┃┗┫┃┣┳┛┃
// ╹ ╹╹╹┗╸╹
 
// ┏━┓╻ ╻╺┳╸┏━┓┏━┓╺┳╸┏━┓┏━┓╺┳╸
// ┣━┫┃ ┃ ┃ ┃ ┃┗━┓ ┃ ┣━┫┣┳┛ ┃ 
// ╹ ╹┗━┛ ╹ ┗━┛┗━┛ ╹ ╹ ╹╹┗╸ ╹ 

spawn-at-startup "hypridle"
spawn-at-startup "mako"
spawn-at-startup "waybar"
spawn-sh-at-startup "swww-daemon" 
spawn-sh-at-startup "/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &"
spawn-sh-at-startup "swww img ~/Downloads/wall.jpg" 

// ╻┏┓╻┏━┓╻ ╻╺┳╸┏━┓
// ┃┃┗┫┣━┛┃ ┃ ┃ ┗━┓
// ╹╹ ╹╹  ┗━┛ ╹ ┗━┛

input {
    keyboard {
        repeat-delay 200
        repeat-rate 35
        // numlock // Uncommenting turns ON numlock on login
        xkb {
            layout "us"
            options "grp:alt_shift_toggle"
        }
    }

    touchpad {
        tap
        dwt
        drag true
        drag-lock
        natural-scroll
    }

    mouse {
        accel-speed 0.2
        accel-profile "flat"
    }

    // warp-mouse-to-focus // Makes cursor warp onto the focused window
    focus-follows-mouse // Focus a window with cursor
}

// ┏┳┓┏━┓┏┓╻╻╺┳╸┏━┓┏━┓┏━┓
// ┃┃┃┃ ┃┃┗┫┃ ┃ ┃ ┃┣┳┛┗━┓
// ╹ ╹┗━┛╹ ╹╹ ╹ ┗━┛╹┗╸┗━┛

output "eDP-1" {
    mode "1920x1080@144.00"
    scale 1
    transform "normal"
    // position x=1280 y=0
    // hot-corners {
    //     off
    // }
}

// ╻  ┏━┓╻ ╻┏━┓╻ ╻╺┳╸
// ┃  ┣━┫┗┳┛┃ ┃┃ ┃ ┃ 
// ┗━╸╹ ╹ ╹ ┗━┛┗━┛ ╹ 

layout {
    gaps 8
    center-focused-column "never"
    default-column-width { proportion 0.60; } // If empty, windows will decide themselves
    background-color "transparent"

    preset-column-widths {
        // proportion 0.25
        // proportion 0.50
        // proportion 0.75

        proportion 0.33333
        proportion 0.50
        proportion 0.66667
    }

    preset-window-heights {
        // proportion 0.25
        // proportion 0.50
        // proportion 0.75

        proportion 0.33333
        proportion 0.50
        proportion 0.66667
    }

    // Visible on active windows only
    focus-ring {
        width 1.5
        active-color "#bb9af7"
        inactive-color "#565f89" // Visible on unfocused monitors
    }

    border {
        off
        width 2
        active-color "#ffc87f"
        inactive-color "#505050"
        urgent-color "#9b0000"
    }

    tab-indicator {
		width 6
		gap 6
		length total-proportion=0.50
		position "top"
		place-within-column
	}

    shadow {
        on
        draw-behind-window true
        softness 30 // Shadow blur radius
        spread 5 // Expands the shadow
        offset x=0 y=5
        color "#0007"
    }

    // Outer gap, <values-below> + gaps
    // struts {
    //     left 8
    //     right 8
    //     top 8
    //     bottom 8
    // }
}

// ┏━┓┏┓╻╻┏┳┓┏━┓╺┳╸╻┏━┓┏┓╻┏━┓
// ┣━┫┃┗┫┃┃┃┃┣━┫ ┃ ┃┃ ┃┃┗┫┗━┓
// ╹ ╹╹ ╹╹╹ ╹╹ ╹ ╹ ╹┗━┛╹ ╹┗━┛

animations {
    // Uncomment untuk mematikan semua animasi sekaligus
    // off

    slowdown 1.3

    workspace-switch {
        spring damping-ratio=1.0 stiffness=1000 epsilon=0.0001
    }

    window-open {
        duration-ms 150
        curve "ease-out-expo"
    }

    window-close {
        duration-ms 150
        curve "ease-out-quad"
    }

    horizontal-view-movement {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }

    window-movement {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }

    window-resize {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }

    config-notification-open-close {
        spring damping-ratio=0.6 stiffness=1000 epsilon=0.001
    }

    exit-confirmation-open-close {
        spring damping-ratio=0.6 stiffness=500 epsilon=0.01
    }

    screenshot-ui-open {
        duration-ms 200
        curve "ease-out-quad"
    }

    overview-open-close {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }
}

// ╻ ╻╻┏┓╻╺┳┓┏━┓╻ ╻   ┏━┓╻ ╻╻  ┏━╸┏━┓
// ┃╻┃┃┃┗┫ ┃┃┃ ┃┃╻┃   ┣┳┛┃ ┃┃  ┣╸ ┗━┓
// ┗┻┛╹╹ ╹╺┻┛┗━┛┗┻┛   ╹┗╸┗━┛┗━╸┗━╸┗━┛

window-rule {
    match app-id=r#"^org\.wezfurlong\.wezterm$"#
    default-column-width {}
}

window-rule {
    match app-id=r#"firefox$"# title="^Picture-in-Picture$"
    open-floating true
}

window-rule {
    open-maximized true
    focus-ring {
          off
      }
}

window-rule {
    match app-id="foot"
    match app-id="Alacritty"
    match app-id="ghostty"
    open-maximized false
    focus-ring {
        on
        width 1.3
        active-color "#bb9af7"
        inactive-color "#565f89" 
    }
}

window-rule {
    match app-id=r#"^org\.keepassxc\.KeePassXC$"#
    match app-id=r#"^org\.gnome\.World\.Secrets$"#
    block-out-from "screen-capture"
}

window-rule {
    geometry-corner-radius 12
    clip-to-geometry true
}

// ╻┏ ┏━╸╻ ╻┏┓ ╻┏┓╻╺┳┓┏━┓
// ┣┻┓┣╸ ┗┳┛┣┻┓┃┃┗┫ ┃┃┗━┓
// ╹ ╹┗━╸ ╹ ┗━┛╹╹ ╹╺┻┛┗━┛

binds {
    // Essentials
    Mod+Return                                         { spawn "ghostty"; }
    Mod+E                                              { spawn "thunar"; }
    Mod+D                                              { spawn "wofi" "--show" "drun"; }
    Mod+Shift+Slash                                    { show-hotkey-overlay; }
    Mod+Shift+Q                                        { quit; }
    Mod+R hotkey-overlay-title="Reload Config"         { spawn-sh "$HOME/.config/niri/launch.sh"; }
    Alt+Tab         repeat=false                       { toggle-overview; }
    Mod+Q           repeat=false                       { close-window; }

    // Screenshots
    Print                                              { screenshot; }
    Mod+Print                                          { screenshot-screen; }
    Ctrl+Print                                         { screenshot-window; }

    // Scripts
    Mod+Alt+B hotkey-overlay-title="Browser Bookmarks" { spawn-sh "$HOME/.config/scripts/bookmarks/bookmarks-wofi.sh"; }
    Mod+Alt+P hotkey-overlay-title="Project Repos"     { spawn-sh "$HOME/.config/scripts/project-repos/pr-wofi.sh"; } 
    Mod+Alt+S hotkey-overlay-title="System Menu"       { spawn-sh "$HOME/.config/scripts/system-menu/sm-wofi.sh"; }  
    Mod+Alt+W hotkey-overlay-title="Wall Switcher"     { spawn-sh "$HOME/.config/scripts/wallpapers/wallpapers-wofi.sh"; }   

    // Navigation
    Mod+H                                              { focus-column-left; }
    Mod+J                                              { focus-window-or-workspace-down; }
    Mod+K                                              { focus-window-or-workspace-up; }
    Mod+L                                              { focus-column-right; }

    // Move column
    Mod+Shift+H                                        { move-column-left; }
    Mod+Shift+J                                        { move-window-down-or-to-workspace-down; }
    Mod+Shift+K                                        { move-window-up-or-to-workspace-up; }
    Mod+Shift+L                                        { move-column-right; }

    // Resize windows
    Mod+Ctrl+H                                         { set-column-width "-10%"; }
    Mod+Ctrl+L                                         { set-column-width "+10%"; }
    Mod+Ctrl+J                                         { set-window-height "-10%"; }
    Mod+Ctrl+K                                         { set-window-height "+10%"; }
    Mod+C                                              { switch-preset-column-width; }
    Mod+Alt+C                                          { switch-preset-window-height; }
    Mod+Ctrl+C                                         { reset-window-height; }
    Mod+F                                              { maximize-column; }
    Mod+Shift+F                                        { fullscreen-window; }

    // Column & floating controls
    Mod+Tab                                            { toggle-column-tabbed-display; }
    Mod+BracketLeft                                    { consume-or-expel-window-left; }
    Mod+BracketRight                                   { consume-or-expel-window-right; }
    Mod+V                                              { toggle-window-floating; }
    Mod+Shift+V                                        { switch-focus-between-floating-and-tiling; }
    Mod+Shift+C                                        { center-column; }
    
    // Workspace navigation
    Mod+1                                              { focus-workspace 1; }
    Mod+2                                              { focus-workspace 2; }
    Mod+3                                              { focus-workspace 3; }
    Mod+4                                              { focus-workspace 4; }
    Mod+5                                              { focus-workspace 5; }
    Mod+6                                              { focus-workspace 6; }
    Mod+7                                              { focus-workspace 7; }
    Mod+8                                              { focus-workspace 8; }
    Mod+9                                              { focus-workspace 9; }

    // Move column to workspace
    Mod+Shift+1                                        { move-column-to-workspace 1; }
    Mod+Shift+2                                        { move-column-to-workspace 2; }
    Mod+Shift+3                                        { move-column-to-workspace 3; }
    Mod+Shift+4                                        { move-column-to-workspace 4; }
    Mod+Shift+5                                        { move-column-to-workspace 5; }
    Mod+Shift+6                                        { move-column-to-workspace 6; }
    Mod+Shift+7                                        { move-column-to-workspace 7; }
    Mod+Shift+8                                        { move-column-to-workspace 8; }
    Mod+Shift+9                                        { move-column-to-workspace 9; }

    // Move workspace
    Mod+Shift+Ctrl+J                                   { move-workspace-down; }
    Mod+Shift+Ctrl+K                                   { move-workspace-up; }

    // Monitor navigation
    Alt+H                                              { focus-monitor-left; }
    Alt+J                                              { focus-monitor-down; }
    Alt+K                                              { focus-monitor-up; }
    Alt+L                                              { focus-monitor-right; }

    // Move column to monitor
    Alt+Shift+H                                        { move-column-to-monitor-left; }
    Alt+Shift+J                                        { move-column-to-monitor-down; }
    Alt+Shift+K                                        { move-column-to-monitor-up; }
    Alt+Shift+L                                        { move-column-to-monitor-right; }

    // Move workspace to monitor                      
    Alt+Shift+Ctrl+H                                   { move-workspace-to-monitor-left; }
    Alt+Shift+Ctrl+J                                   { move-workspace-to-monitor-down; }
    Alt+Shift+Ctrl+K                                   { move-workspace-to-monitor-up; }
    Alt+Shift+Ctrl+L                                   { move-workspace-to-monitor-right; }

    // System
    XF86AudioPlay                                      { spawn-sh "playerctl play-pause"; }
    XF86AudioNext                                      { spawn-sh "playerctl next"; }
    XF86AudioPrev                                      { spawn-sh "playerctl previous"; }
    XF86AudioRaiseVolume  allow-when-locked=true       { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+"; }
    XF86AudioLowerVolume  allow-when-locked=true       { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-"; }
    XF86AudioMute         allow-when-locked=true       { spawn-sh "wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle"; }
    XF86AudioMicMute      allow-when-locked=true       { spawn-sh "wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle"; }
    XF86MonBrightnessUp   allow-when-locked=true       { spawn-sh "brightnessctl set +5%"; }
    XF86MonBrightnessDown allow-when-locked=true       { spawn-sh "brightnessctl set 5%-"; }
    Mod+Shift+Escape      allow-inhibiting=false       { toggle-keyboard-shortcuts-inhibit; }
    Mod+Shift+Alt+P                                    { power-off-monitors; }

    // Mouse binds
    Mod+Shift+WheelScrollUp                            { focus-column-left; }
    Mod+WheelScrollDown       cooldown-ms=150          { focus-workspace-down; }
    Mod+WheelScrollUp         cooldown-ms=150          { focus-workspace-up; }
    Mod+Shift+WheelScrollDown                          { focus-column-right; }
}

// ┏┳┓╻┏━┓┏━╸
// ┃┃┃┃┗━┓┃  
// ╹ ╹╹┗━┛┗━╸

prefer-no-csd
hotkey-overlay { skip-at-startup; }
screenshot-path "~/Pictures/Screenshots/Screenshot from %Y-%m-%d %H-%M-%S.png"

// Wallpapers in overview
layer-rule {
    match namespace="^wallpaper$"
    place-within-backdrop true
}

cursor {
    xcursor-theme "Bibata-Modern-Ice"
    xcursor-size 24

    hide-when-typing
    hide-after-inactive-ms 10000
}

// Disable hot corners
gestures {
    hot-corners {
        // off
    }
}
